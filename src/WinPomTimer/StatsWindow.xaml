<Window x:Class="WinPomTimer.StatsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="統計ダッシュボード"
        Width="860"
        Height="560"
        MinWidth="760"
        MinHeight="480"
        WindowStartupLocation="CenterOwner"
        Background="#FFF7F8FC"
        FontFamily="Yu Gothic UI">
  <Grid Margin="14">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <DockPanel Grid.Row="0" Margin="0,0,0,10">
      <StackPanel DockPanel.Dock="Left" Orientation="Horizontal" VerticalAlignment="Center">
        <TextBlock VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold" Text="グラフ" />
        <ComboBox x:Name="GraphTypeCombo" Width="180" SelectionChanged="GraphTypeCombo_SelectionChanged">
          <ComboBoxItem Content="" />
          <ComboBoxItem Content="日" />
          <ComboBoxItem Content="週" />
          <ComboBoxItem Content="月" />
          <ComboBoxItem Content="年" />
        </ComboBox>
        <TextBlock VerticalAlignment="Center" Margin="10,0,6,0" FontWeight="SemiBold" Text="集計軸" />
        <ComboBox x:Name="AxisModeCombo" Width="140" SelectionChanged="AxisModeCombo_SelectionChanged">
          <ComboBoxItem Content="作業内容" />
          <ComboBoxItem Content="クライアント" />
          <ComboBoxItem Content="クライアント×作業" />
        </ComboBox>
        <Button x:Name="PrevRangeButton" Width="34" Margin="8,0,0,0" Content="&lt;" Click="PrevRange_Click" />
        <Button x:Name="NextRangeButton" Width="34" Margin="6,0,0,0" Content="&gt;" Click="NextRange_Click" />
        <Button x:Name="TodayRangeButton" Width="58" Margin="6,0,0,0" Content="今日" Click="TodayRange_Click" />
        <TextBlock x:Name="RangeLabelText"
                   Margin="10,0,0,0"
                   VerticalAlignment="Center"
                   Foreground="#4E5E7D"
                   FontWeight="SemiBold"
                   Text="全期間" />
      </StackPanel>

      <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
        <Button Width="100" Margin="6,0,0,0" Content="JSON出力" Click="ExportJson_Click" />
        <Button Width="100" Margin="6,0,0,0" Content="CSV出力" Click="ExportCsv_Click" />
        <Button Width="100" Margin="6,0,0,0" Content="ICS出力" Click="ExportIcs_Click" />
      </StackPanel>
    </DockPanel>

    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="2.4*" />
        <ColumnDefinition Width="1.4*" />
      </Grid.ColumnDefinitions>

      <Border Grid.Column="0"
              Margin="0,0,10,0"
              Background="White"
              BorderBrush="#FFCFD8E6"
              BorderThickness="1"
              CornerRadius="10"
              Padding="10">
        <Grid>
          <Canvas x:Name="ChartCanvas" />
          <TextBlock x:Name="ChartPlaceholderText"
                     HorizontalAlignment="Center"
                     VerticalAlignment="Center"
                     Foreground="#6A7896"
                     FontSize="14"
                     Text="グラフ種別を選択すると描画されます。" />
        </Grid>
      </Border>

      <Border Grid.Column="1"
              Background="White"
              BorderBrush="#FFCFD8E6"
              BorderThickness="1"
              CornerRadius="10"
              Padding="10">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>
          <TextBlock Grid.Row="0" FontWeight="SemiBold" Margin="0,0,0,6" Text="カテゴリ別サマリー" />
          <TextBlock x:Name="SummaryAxisText"
                     Grid.Row="1"
                     Margin="0,0,0,8"
                     Foreground="#4E5E7D"
                     Text="軸: 作業内容" />
          <DataGrid x:Name="TagSummaryGrid"
                    Grid.Row="2"
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    CanUserDeleteRows="False"
                    CanUserResizeRows="False"
                    IsReadOnly="True"
                    HeadersVisibility="Column"
                    GridLinesVisibility="Horizontal">
            <DataGrid.Columns>
              <DataGridTemplateColumn Header="" Width="30">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <Border Width="14"
                            Height="14"
                            CornerRadius="3"
                            Background="{Binding CategoryBrush}"
                            BorderBrush="#FFBBC7DA"
                            BorderThickness="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center" />
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>
              <DataGridTextColumn Header="カテゴリ" Binding="{Binding TagName}" Width="*" />
              <DataGridTextColumn Header="時間" Binding="{Binding TotalTimeText}" Width="88" />
              <DataGridTextColumn Header="件数" Binding="{Binding Count}" Width="56" />
            </DataGrid.Columns>
          </DataGrid>
          <TextBlock x:Name="TagSummaryTotalText"
                     Grid.Row="3"
                     Margin="0,8,0,0"
                     Foreground="#3E4E6D"
                     FontWeight="SemiBold"
                     Text="総計: 00:00 (0分)" />
        </Grid>
      </Border>
    </Grid>
  </Grid>
</Window>
